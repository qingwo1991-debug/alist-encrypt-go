import{w as S,H as T,V as k,r,E as H,g as c,h as x,j as i,F,b as y,c as t,i as n,l as U,W as z,d as B,q as p,p as E,X as N,P as _}from"./index-8063b7cb.js";const j={class:"scroll-y"},q={class:"mt-30px font-bold mb-10px"},R=B({}),O=Object.assign(R,{__name:"index",setup(D){const b=p("right"),d=p(!1),m=p(!1),u=p(!1),l=E({address:"0.0.0.0",http_port:5344,https_port:-1,force_https:!1,cert_file:"",key_file:"",unix_file:"",unix_file_perm:"",enable_h2c:!1});S(()=>l.enable_h2c,o=>{m.value=o!==u.value});const v=async()=>{d.value=!0;try{const o=await N(l);o.data&&o.data.needRestart?(_.warning("Server is restarting to apply H2C changes..."),setTimeout(()=>{window.location.reload()},2e3)):_.success("Configuration saved"),u.value=l.enable_h2c,m.value=!1}catch{_.error("Failed to save configuration")}finally{d.value=!1}};return T(async()=>{try{const o=await k();o.data&&(Object.assign(l,o.data),u.value=o.data.enable_h2c||!1)}catch(o){console.error("Failed to load scheme config:",o)}}),(o,e)=>{const f=r("el-input"),s=r("el-form-item"),g=r("el-input-number"),h=r("el-switch"),w=r("el-button"),V=r("el-form"),C=r("el-alert"),P=H("lang");return c(),x("div",j,[e[12]||(e[12]=i("h3",null,"Server Configuration",-1)),F((c(),x("div",q,[...e[6]||(e[6]=[y("Proxy Server Settings",-1)])])),[[P]]),t(V,{ref:"refForm","label-position":b.value,"label-width":"120px",model:l},{default:n(()=>[t(s,{prop:"address",label:"Listen Address"},{default:n(()=>[t(f,{modelValue:l.address,"onUpdate:modelValue":e[0]||(e[0]=a=>l.address=a),style:{"max-width":"260px"},placeholder:"0.0.0.0"},null,8,["modelValue"]),e[7]||(e[7]=i("span",{color:"gray",style:{"font-size":"12px","margin-left":"12px"}},"IP address to bind (0.0.0.0 for all interfaces)",-1))]),_:1}),t(s,{prop:"http_port",label:"HTTP Port"},{default:n(()=>[t(g,{modelValue:l.http_port,"onUpdate:modelValue":e[1]||(e[1]=a=>l.http_port=a),min:1,max:65535,style:{"max-width":"260px"}},null,8,["modelValue"]),e[8]||(e[8]=i("span",{color:"gray",style:{"font-size":"12px","margin-left":"12px"}},"Proxy server HTTP port",-1))]),_:1}),t(s,{prop:"enable_h2c",label:"Enable H2C"},{default:n(()=>[t(h,{modelValue:l.enable_h2c,"onUpdate:modelValue":e[2]||(e[2]=a=>l.enable_h2c=a),class:"ml-2",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue"]),e[9]||(e[9]=i("span",{color:"gray",style:{"font-size":"12px","margin-left":"12px"}},"HTTP/2 cleartext (h2c) for incoming connections",-1))]),_:1}),t(s,{prop:"https_port",label:"HTTPS Port"},{default:n(()=>[t(g,{modelValue:l.https_port,"onUpdate:modelValue":e[3]||(e[3]=a=>l.https_port=a),min:-1,max:65535,style:{"max-width":"260px"}},null,8,["modelValue"]),e[10]||(e[10]=i("span",{color:"gray",style:{"font-size":"12px","margin-left":"12px"}},"Set to -1 to disable HTTPS",-1))]),_:1}),t(s,{prop:"cert_file",label:"Cert File"},{default:n(()=>[t(f,{modelValue:l.cert_file,"onUpdate:modelValue":e[4]||(e[4]=a=>l.cert_file=a),style:{"max-width":"360px"},placeholder:"/path/to/cert.pem"},null,8,["modelValue"])]),_:1}),t(s,{prop:"key_file",label:"Key File"},{default:n(()=>[t(f,{modelValue:l.key_file,"onUpdate:modelValue":e[5]||(e[5]=a=>l.key_file=a),style:{"max-width":"360px"},placeholder:"/path/to/key.pem"},null,8,["modelValue"])]),_:1}),t(s,null,{default:n(()=>[t(w,{type:"primary",loading:d.value,onClick:v},{default:n(()=>[...e[11]||(e[11]=[y("Save",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["label-position","model"]),m.value?(c(),U(C,{key:0,title:"Server will restart to apply H2C changes",type:"warning",closable:!1,"show-icon":"",style:{"margin-top":"20px","max-width":"500px"}})):z("",!0)])}}});export{O as default};
