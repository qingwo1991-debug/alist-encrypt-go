import{d as C,a as c,e as q,D as B,r as p,E as D,g as m,h as w,F as b,b as a,c as o,i as n,k as l,q as V,p as E,G as d,H as P,I as R}from"./index-b9e95577.js";const I={class:"scroll-y"},L={class:"mt-10px mb-10px font-bold"},N={class:"mt-10px mb-10px font-bold"},G={class:"mt-30px font-bold mb-10px"},H=C({}),O=C({...H,__name:"index",setup(M){const U=V("right"),v=c(),f=q(),{settings:j,userInfo:_}=f,{setTheme:k,theme:A,setSize:S,size:J,setLanguage:h}=B();S("default");const y=t=>{h(t)},s=E({username:"",originalUsername:"",password:"",newpassword:""}),z=V();s.username=_.username,s.originalUsername=_.username;const F=()=>{if(!s.password){d.error("请输入原密码");return}if(!s.newpassword){d.error("请输入新密码");return}P({username:s.originalUsername,password:s.password,newpassword:s.newpassword}).then(t=>{d.success("密码修改成功，请重新登录"),f.setToken(""),v.push("/login")}).catch(t=>{d.error((t==null?void 0:t.msg)||"修改失败")})},T=()=>{if(!s.password){d.error("请输入密码以验证身份");return}if(!s.username||s.username.length<3){d.error("用户名至少需要3个字符");return}if(s.username===s.originalUsername){d.warning("用户名未变更");return}R({username:s.originalUsername,password:s.password,newusername:s.username}).then(t=>{d.success("用户名修改成功，请重新登录"),f.setToken(""),v.push("/login")}).catch(t=>{d.error((t==null?void 0:t.msg)||"修改失败")})};return(t,e)=>{const i=p("el-button"),g=p("el-input"),u=p("el-form-item"),$=p("el-form"),x=D("lang");return m(),w("div",I,[b((m(),w("div",L,[...e[7]||(e[7]=[a("主题切换",-1)])])),[[x]]),o(i,{onClick:e[0]||(e[0]=r=>l(k)("lighting-theme"))},{default:n(()=>[...e[8]||(e[8]=[a("lighting-theme",-1)])]),_:1}),o(i,{onClick:e[1]||(e[1]=r=>l(k)("dark"))},{default:n(()=>[...e[9]||(e[9]=[a("dark-theme",-1)])]),_:1}),b((m(),w("div",N,[...e[10]||(e[10]=[a("switch language",-1)])])),[[x]]),o(i,{onClick:e[2]||(e[2]=r=>y("en"))},{default:n(()=>[...e[11]||(e[11]=[a("en",-1)])]),_:1}),o(i,{onClick:e[3]||(e[3]=r=>y("zh"))},{default:n(()=>[...e[12]||(e[12]=[a("zh",-1)])]),_:1}),b((m(),w("div",G,[...e[13]||(e[13]=[a("账号设置",-1)])])),[[x]]),o($,{ref_key:"refSearchForm",ref:z,"label-position":U.value,"label-width":"80px",model:l(s)},{default:n(()=>[o(u,{prop:"username",label:"用户名"},{default:n(()=>[o(g,{modelValue:l(s).username,"onUpdate:modelValue":e[4]||(e[4]=r=>l(s).username=r),style:{"max-width":"260px"},placeholder:"username"},null,8,["modelValue"]),o(i,{type:"primary",style:{"margin-left":"10px"},onClick:T},{default:n(()=>[...e[14]||(e[14]=[a("修改用户名",-1)])]),_:1})]),_:1}),o(u,{prop:"password",label:"原密码"},{default:n(()=>[o(g,{modelValue:l(s).password,"onUpdate:modelValue":e[5]||(e[5]=r=>l(s).password=r),style:{"max-width":"260px"},type:"password",placeholder:"password"},null,8,["modelValue"])]),_:1}),o(u,{prop:"newpassword",label:"新密码"},{default:n(()=>[o(g,{modelValue:l(s).newpassword,"onUpdate:modelValue":e[6]||(e[6]=r=>l(s).newpassword=r),style:{"max-width":"260px"},type:"password",placeholder:"password"},null,8,["modelValue"])]),_:1}),o(u,null,{default:n(()=>[o(i,{type:"primary",onClick:F},{default:n(()=>[...e[15]||(e[15]=[a("修改密码",-1)])]),_:1})]),_:1})]),_:1},8,["label-position","model"])])}}});export{O as default};
